{"ast":null,"code":"var _jsxFileName = \"/Users/hughphung/Documents/RMIT/2021/SEPT/SEPT-TEAM/SEPT-Team-6/code/FrontEnd/book-shop/src/components/My-Listings/MyListings.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport { Col, Container, Row, Table, Button } from 'react-bootstrap';\nimport { NavLink } from 'react-router-dom';\nimport axios from 'axios';\nimport './MyListings.css';\nimport { useSessionUser } from '../../Hooks/useSessionUser';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const MyListings = () => {\n  _s();\n\n  const {\n    sessionUser\n  } = useSessionUser();\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [listingsData, setListingsData] = useState(null);\n  const [bookData, setBookData] = useState(null);\n  const [completeData, setCompleteData] = useState([]);\n\n  const getListingsContents = async () => {\n    try {\n      const config = {\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      };\n      const sellerRequest = {\n        seller: String(sessionUser.username)\n      };\n      console.log(\"CUNT\");\n      const response = await axios.post('http://localhost:8082/api/listings/getlistingsbyseller', sellerRequest, config);\n      console.log(\"Listings response\", response);\n\n      if (response.status === 200) {\n        console.log(response.status);\n        return response.data;\n      } else {}\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const getBookContents = async () => {\n    try {\n      const response = await axios.get('http://localhost:8081/api/books/getallbooks');\n      return response.data;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    async function fetchData() {\n      console.log(\"GOTCHA BITCH\", dataLoaded);\n\n      if (dataLoaded === false) {\n        const listingsDataFetched = await getListingsContents();\n        const bookDataFetched = await getBookContents();\n        console.log(\"Listings fetched\", listingsDataFetched);\n        console.log(\"Books fetched\", bookDataFetched);\n\n        if (listingsDataFetched && bookDataFetched) {\n          if (!listingsDataFetched.results && !bookDataFetched.results) {\n            let data = []; // setListingsData(listingsDataFetched);\n            // setBookData(bookDataFetched);\n\n            for (const listing of listingsDataFetched) {\n              let listingItem = {\n                type: listing.type,\n                price: listing.price,\n                sold: listing.sold\n              };\n\n              for (const book of bookDataFetched) {\n                if (listing.bookId === book.id) {\n                  listingItem = { ...listingItem,\n                    bookId: book.id,\n                    title: book.title,\n                    author: book.author\n                  };\n                  data.push(listingItem);\n                }\n              }\n            }\n\n            console.log(\"Combined\", data);\n            setCompleteData(data); // console.log(\"Combined\", completeData);\n\n            setDataLoaded(true); // const combined = Object.assign(listingsData, bookData);\n            // setCompleteData({\n            //     bookId:bookData.id,\n            //     title:bookData.title,\n            //     author:bookData.author,\n            //     type:listingsData.type,\n            //     price:listingsData.price,\n            //     sold:listingsData.sold\n            // });\n            // console.log(\"HOWDY NEIGHBOUR\")\n            // console.log(\"Combined Data\", completeData)\n          }\n        } else {\n          setListingsData();\n          setBookData();\n          setDataLoaded(true);\n        }\n      }\n    }\n\n    fetchData();\n  }, [listingsData, bookData, completeData, dataLoaded]);\n\n  if (completeData) {\n    console.log(\"listings data\", listingsData);\n    console.log(\"book data\", bookData);\n    const allData = completeData.map(listItem => {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.bookId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.author\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.type\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.price\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 17\n        }, this), listItem.sold ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Sold\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 22\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Not sold\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 22\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: listItem.sold\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 17\n      }, this);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"addListing\",\n              children: /*#__PURE__*/_jsxDEV(NavLink, {\n                to: \"/create-listing\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"success\",\n                  style: {\n                    width: '100px'\n                  },\n                  children: \"Add\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          striped: true,\n          bordered: true,\n          hover: true,\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Book ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Author\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: allData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"My Listings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"addListing\",\n              children: /*#__PURE__*/_jsxDEV(NavLink, {\n                to: \"/create-listing\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"success\",\n                  style: {\n                    width: '100px'\n                  },\n                  children: \"Add\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          striped: true,\n          bordered: true,\n          hover: true,\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Book ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Author\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }, this);\n  }\n};\n\n_s(MyListings, \"Y28TSzbEUf9xD2GoXVu99Z6OJIc=\", false, function () {\n  return [useSessionUser];\n});\n\n_c = MyListings;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyListings\");","map":{"version":3,"sources":["/Users/hughphung/Documents/RMIT/2021/SEPT/SEPT-TEAM/SEPT-Team-6/code/FrontEnd/book-shop/src/components/My-Listings/MyListings.js"],"names":["React","useState","useEffect","Col","Container","Row","Table","Button","NavLink","axios","useSessionUser","MyListings","sessionUser","dataLoaded","setDataLoaded","listingsData","setListingsData","bookData","setBookData","completeData","setCompleteData","getListingsContents","config","headers","Accept","sellerRequest","seller","String","username","console","log","response","post","status","data","error","getBookContents","get","fetchData","listingsDataFetched","bookDataFetched","results","listing","listingItem","type","price","sold","book","bookId","id","title","author","push","allData","map","listItem","width"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { useState, useEffect} from 'react'\nimport { Col, Container, Row, Table, Button} from 'react-bootstrap'\nimport { NavLink } from 'react-router-dom'\nimport axios from 'axios'\nimport './MyListings.css'\nimport { useSessionUser } from '../../Hooks/useSessionUser'\n\nexport const MyListings = () => {\n    const {sessionUser} = useSessionUser();\n    const[dataLoaded,setDataLoaded] = useState(false);\n    const[listingsData, setListingsData] = useState(null);\n    const[bookData, setBookData] = useState(null);\n    const[completeData, setCompleteData] = useState([]);\n\n    const getListingsContents = async () =>\n    {\n        try\n        {\n            const config = \n            {\n              headers: {\n                  Accept: 'application/json',\n                  'Content-Type': 'application/json',\n                  'Access-Control-Allow-Origin': '*',\n              },\n\n            }\n\n            const sellerRequest = \n            {\n                seller:String(sessionUser.username)\n            }\n\n            console.log(\"CUNT\")\n            const response = await axios.post('http://localhost:8082/api/listings/getlistingsbyseller', sellerRequest, config);\n\n            console.log(\"Listings response\", response);\n\n            if (response.status === 200)\n            {\n                console.log(response.status)\n                return response.data;\n            }\n            else\n            {\n\n            }\n        }\n        catch (error)\n        {\n            console.log(error)\n        }\n    }\n\n    const getBookContents= async () =>\n    {\n        try\n        {\n            const response = await axios.get('http://localhost:8081/api/books/getallbooks');\n\n            return response.data;\n        }\n        catch (error)\n        {\n            console.log(error)\n        }\n    }\n\n    useEffect(()=>\n    {\n        async function fetchData() {\n            console.log(\"GOTCHA BITCH\", dataLoaded)\n            if (dataLoaded === false)\n            {\n                const listingsDataFetched = await getListingsContents();\n                const bookDataFetched = await getBookContents();\n                console.log(\"Listings fetched\", listingsDataFetched);\n                console.log(\"Books fetched\", bookDataFetched);\n\n                if (listingsDataFetched && bookDataFetched)\n                {\n                    if (!listingsDataFetched.results && !bookDataFetched.results)\n                    {\n                        let data = []\n                        // setListingsData(listingsDataFetched);\n                        // setBookData(bookDataFetched);\n                        for(const listing of listingsDataFetched){\n                            let listingItem = {\n                                type:listing.type,\n                                price:listing.price,\n                                sold:listing.sold\n                                \n                            }\n                            for(const book of bookDataFetched){\n                                if(listing.bookId === book.id){\n                                    listingItem = {\n                                        ...listingItem, \n                                        bookId:book.id,\n                                        title:book.title,\n                                        author:book.author\n                                    }\n                                    data.push(listingItem)\n                                }\n                            }\n                        }\n\n                        console.log(\"Combined\", data);\n\n                        setCompleteData(data);\n                        // console.log(\"Combined\", completeData);\n\n                        \n                        setDataLoaded(true);\n\n                        // const combined = Object.assign(listingsData, bookData);\n                        // setCompleteData({\n                        //     bookId:bookData.id,\n                        //     title:bookData.title,\n                        //     author:bookData.author,\n                        //     type:listingsData.type,\n                        //     price:listingsData.price,\n                        //     sold:listingsData.sold\n                        // });\n                        // console.log(\"HOWDY NEIGHBOUR\")\n\n                        // console.log(\"Combined Data\", completeData)\n                    }   \n                }\n                else\n                {\n                    setListingsData();\n                    setBookData();\n                    setDataLoaded(true);\n                }\n            }\n        }\n        fetchData();\n\n    },  [listingsData, bookData, completeData, dataLoaded])\n\n    if(completeData)\n    {\n        console.log(\"listings data\", listingsData)\n        console.log(\"book data\", bookData)\n        const allData = completeData.map(listItem => {\n            return (\n                \n                <tr>\n                <td>{listItem.bookId}</td>\n                <td>{listItem.title}</td>\n                <td>{listItem.author}</td>\n                <td>{listItem.type}</td>\n                <td>{listItem.price}</td>\n                {\n                    listItem.sold\n                    ?\n                    (<div>\n                        Sold\n                    </div>)\n                    :\n                    (<div>\n                        Not sold\n                    </div>\n                    )\n\n\n                }\n                <td>{listItem.sold}</td>\n                </tr>\n            )\n        })\n\n        return(\n            <div>\n            <Container>\n                <Row>\n                    <Col>\n                        <div className='addListing'>\n                            <NavLink to = \"/create-listing\">\n                            <Button variant ='success' style={{width:'100px'}}>\n                                Add\n                            </Button>\n                            </NavLink>\n                        </div>\n                    </Col>\n                </Row>\n            </Container>\n\n            <Container>\n                <Table striped bordered hover>\n                    <thead>\n                        <tr>\n                        <th>Book ID</th>\n                        <th>Title</th>\n                        <th>Author</th>\n                        <th>Type</th>\n                        <th>Price</th>\n                        <th>Status</th>\n\n             \n                        </tr>\n                    </thead>\n                    <tbody>\n                        {allData}\n                    </tbody>\n\n                </Table>\n                \n            </Container>\n        \n\n            </div>\n        )\n    }\n    else{\n        return (\n            <div>\n                <Container>\n                    <h1>\n                        My Listings\n                    </h1>\n                </Container>\n                <Container>\n\n                    <Row>\n                        <Col>\n                            <div className='addListing'>\n                                <NavLink to = \"/create-listing\">\n                                    <Button variant ='success' style={{width:'100px'}}>\n                                        Add\n                                    </Button>\n                                </NavLink>\n                            </div>\n                        </Col>\n                    </Row>\n                </Container>\n                <Container>\n                    <Table striped bordered hover>\n                    <thead>\n                        <tr>\n                        <th>Book ID</th>\n                        <th>Title</th>\n                        <th>Author</th>\n                        <th>Type</th>\n                        <th>Price</th>\n                        <th>Status</th>\n\n             \n                        </tr>\n                    </thead>\n                    <tbody>\n\n                    </tbody>\n\n                </Table>\n                </Container>\n            </div>\n    \n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}